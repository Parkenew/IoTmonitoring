# 서초구 실내공기질 시각화

## 1. 프로젝트 개요

---

### **1-1. 프로젝트 목표**

본 프로젝트는 서초구 다중이용시설 공조시스템 관리자가 시설 내의 공기질 데이터를 실시간으로 모니터링할 수 있도록 돕고, 향후 IoT 디바이스와 연동한 스마트 실내 환경 시스템을 구축하는 것을 목표로 함.

### **1-2. 프로젝트 기대효과**

- **실시간 실내공기질 모니터링**: 온도, 습도, 미세먼지, 이산화탄소, 소음 등 눈에 보이지 않는 공기질 데이터를 수치화하여 실시간으로 제공.
- **데이터 통계 제공**: 요일별, 시간별 통계 데이터를 제공하여 장비 오류 및 공기질 이상 징후를 시각적으로 알 수 있도록 함.
- **데이터 기반 시설 운영**: 공기질 악화 시 즉시 조치 가능하도록 데이터 기반 의사결정 지원.

### **1-4. 활용 기술 스택**

- Java(JDK21)
- Apache Kafka(3.9.0)
- Filebeat(8.1.1), Logstash(8.13.3), Elasticsearch(8.13.3), Kibana(8.13.3)

## 2. 데이터 처리

---

### 2-1. 활용 데이터셋

[서울특별시 서초구_다중이용시설 IoT 과거 실내공기질 가공 데이터_20211210](https://www.data.go.kr/data/15095892/fileData.do)

- **설명**
    
    서초구 그린안심존으로 인증된 다중이용시설에 설치되어 있는 IoT 실내공기질 측정 데이터로
    2021년 8월부터 11월까지의 가공 데이터셋 사용
    
    - 서버 부하를 고려해 80개의 로그파일 중 임의의 5개 로그파일만 사용
    - 8월 데이터를 사용하여 현재 온도 보다 높음
- **측정 항목**
    
    미세먼지(ug/m³), 초미세먼지(ug/m³), 이산화탄소(ppm), 휘발성유기화합물(ppb), 온도(℃),
    습도(%), 소음(dB), 통합지수(CICI)
  
### 2-2. 데이터 흐름도

![](attachment:994da528-2288-453d-aed6-e24ab83a23e4:서초구_실내공기질_데이터_시각화_1aec5c08028080019c51cdc256c51988스크린샷_2025-03-20_오후_4.46.28.png)

- **IoT Dev.(Java):** 데이터셋을 실제 측정 장비처럼 구현하기 위해 장비 시리얼 넘버로 구분된 5개의 데이터 파일에서 매분마다 한줄씩 순서대로 읽어서 하나의 CSV파일에 기록.
- **CSV File(Filebeat):** CSV파일에 데이터가 쓰일때마다 Filebeat가 해당 데이터를 수집하여 Kafka로 전송.
- **Apache Kafka:** Filebeat에서 수집한 실시간 데이터들을 토픽으로 구분하여 분산 저장.
- **Lostasth:** 해당 토픽에 대한 데이터를 수집하고 변환.
- **Elasticsearch:** 변환된 데이터를 인덱싱하여 저장.
- **Kibana:** Elasticsearch에 저장된 데이터를 시각화하여 실내공기질 데이터를 실시간 모니터링.

### 2-3. 데이터 수집 및 가공 과정

- **실시간 데이터 수집**
    - 각 장비의 데이터를 분마다 읽어서 하나의 csv파일에 추가하는 Java 코드 작성하여 구현.
    - Log 예시
        
        ![](attachment:82ff0c98-ae05-4067-99f9-0afa624cf180:서초구_실내공기질_데이터_시각화_1aec5c08028080019c51cdc256c51988image.png)
        
    - Filebeat를 사용하여 실시간 모니터링.
- **Pub/Sub 모델을 사용한 효율적인 데이터 수집**
    - Kafka를 사용하여 Filebeat(Publisher)가 Topic에 발행한 데이터를 보관.
    - Logstash(Subscriber)가 해당 토픽 구독.
    - 토픽에 저장된 데이터 예시
        
        ![](attachment:7a20a474-8749-4868-94a3-cc6a6d0a1a89:서초구_실내공기질_데이터_시각화_1aec5c08028080019c51cdc256c51988image_1.png)
        
    
- **인덱스 라이프사이클 관리 및 인덱스 템플릿 적용**
    - 인덱스 1일 주기 롤오버, 14일 주기 삭제.
    - 인덱스 템플릿에 Data Stream 적용하여 실시간 데이터 수집.
      
- **Logstash filter를 사용하여 데이터 전처리 후 Elasticsearch에 적재**
    
